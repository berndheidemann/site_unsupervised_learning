<!doctype html><html lang=de class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://berndheidemann.github.io/site_unsupervised_learning/arbeitsblaetter/ul-06-hierarchisch/ rel=canonical><link href=../ul-05-interpretation/ rel=prev><link href=../ul-07-kundensegmentierung/ rel=next><link rel=icon href=../../assets/images/favicon.png><meta name=generator content="mkdocs-1.6.1, mkdocs-material-9.7.1"><title>UL-06 Hierarchisch - Unsupervised Learning</title><link rel=stylesheet href=../../assets/stylesheets/main.484c7ddc.min.css><link rel=stylesheet href=../../assets/stylesheets/palette.ab4e12ef.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../assets/css/pdf-viewer.css><script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=orange> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#ul-06-hierarchisches-clustering class=md-skip> Zum Inhalt </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Kopfzeile> <a href=../.. title="Unsupervised Learning" class="md-header__button md-logo" aria-label="Unsupervised Learning" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Unsupervised Learning </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> UL-06 Hierarchisch </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=teal data-md-color-accent=orange aria-label="Zu Dark Mode wechseln" type=radio name=__palette id=__palette_0> <label class="md-header__button md-icon" title="Zu Dark Mode wechseln" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=teal data-md-color-accent=orange aria-label="Zu Light Mode wechseln" type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Zu Light Mode wechseln" for=__palette_0 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg> </label> </form> <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Suche placeholder=Suche autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg> </label> <nav class=md-search__options aria-label=Suche> <button type=reset class="md-search__icon md-icon" title=Zurücksetzen aria-label=Zurücksetzen tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg> </button> </nav> <div class=md-search__suggest data-md-component=search-suggest></div> </form> <div class=md-search__output> <div class=md-search__scrollwrap tabindex=0 data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Suche wird initialisiert </div> <ol class=md-search-result__list role=presentation></ol> </div> </div> </div> </div> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Hauptnavigation data-md-component=tabs> <div class=md-grid> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../.. class=md-tabs__link> Start </a> </li> <li class="md-tabs__item md-tabs__item--active"> <a href=../ul-01-einfuehrung/ class=md-tabs__link> Arbeitsblätter </a> </li> <li class=md-tabs__item> <a href=../../infoblaetter/einfuehrung-unsupervised/ class=md-tabs__link> Infoblätter </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../.. title="Unsupervised Learning" class="md-nav__button md-logo" aria-label="Unsupervised Learning" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg> </a> Unsupervised Learning </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../.. class=md-nav__link> <span class=md-ellipsis> Start </span> </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2 id=__nav_2_label tabindex> <span class=md-ellipsis> Arbeitsblätter </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_2_label aria-expanded=true> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Arbeitsblätter </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_1 checked> <label class=md-nav__link for=__nav_2_1 id=__nav_2_1_label tabindex> <span class=md-ellipsis> Phase 1 - Einführung </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_1_label aria-expanded=true> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Phase 1 - Einführung </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ul-01-einfuehrung/ class=md-nav__link> <span class=md-ellipsis> UL-01 Einführung </span> </a> </li> <li class=md-nav__item> <a href=../ul-02-vorverarbeitung/ class=md-nav__link> <span class=md-ellipsis> UL-02 Vorverarbeitung </span> </a> </li> <li class=md-nav__item> <a href=../ul-03-kmeans/ class=md-nav__link> <span class=md-ellipsis> UL-03 K-Means </span> </a> </li> <li class=md-nav__item> <a href=../ul-04-pca/ class=md-nav__link> <span class=md-ellipsis> UL-04 PCA </span> </a> </li> <li class=md-nav__item> <a href=../ul-05-interpretation/ class=md-nav__link> <span class=md-ellipsis> UL-05 Interpretation </span> </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> <span class=md-ellipsis> UL-06 Hierarchisch </span> <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> <span class=md-ellipsis> UL-06 Hierarchisch </span> </a> <nav class="md-nav md-nav--secondary" aria-label=Inhaltsverzeichnis> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Inhaltsverzeichnis </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#lernziele class=md-nav__link> <span class=md-ellipsis> Lernziele </span> </a> </li> <li class=md-nav__item> <a href=#aufgabe-1-daten-vorbereiten class=md-nav__link> <span class=md-ellipsis> Aufgabe 1: Daten vorbereiten </span> </a> </li> <li class=md-nav__item> <a href=#aufgabe-2-linkage-matrix-berechnen class=md-nav__link> <span class=md-ellipsis> Aufgabe 2: Linkage-Matrix berechnen </span> </a> </li> <li class=md-nav__item> <a href=#aufgabe-3-dendrogramm-erstellen class=md-nav__link> <span class=md-ellipsis> Aufgabe 3: Dendrogramm erstellen </span> </a> </li> <li class=md-nav__item> <a href=#aufgabe-4-schnitt-auf-gewunschter-hohe class=md-nav__link> <span class=md-ellipsis> Aufgabe 4: Schnitt auf gewünschter Höhe </span> </a> </li> <li class=md-nav__item> <a href=#aufgabe-6-vergleich-k-means-vs-hierarchisches-clustering class=md-nav__link> <span class=md-ellipsis> Aufgabe 6: Vergleich K-Means vs. Hierarchisches Clustering </span> </a> </li> <li class=md-nav__item> <a href=#aufgabe-7-verschiedene-linkage-methoden-vergleichen class=md-nav__link> <span class=md-ellipsis> Aufgabe 7: Verschiedene Linkage-Methoden vergleichen </span> </a> </li> <li class=md-nav__item> <a href=#aufgabe-8-vor-und-nachteile-diskutieren class=md-nav__link> <span class=md-ellipsis> Aufgabe 8: Vor- und Nachteile diskutieren </span> </a> </li> <li class=md-nav__item> <a href=#haufige-fehler class=md-nav__link> <span class=md-ellipsis> Häufige Fehler </span> </a> </li> <li class=md-nav__item> <a href=#zusammenfassung class=md-nav__link> <span class=md-ellipsis> Zusammenfassung </span> </a> </li> <li class=md-nav__item> <a href=#nachste-schritte class=md-nav__link> <span class=md-ellipsis> Nächste Schritte </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2 id=__nav_2_2_label tabindex> <span class=md-ellipsis> Phase 2 - Anwendung </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_2_label aria-expanded=false> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Phase 2 - Anwendung </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ul-07-kundensegmentierung/ class=md-nav__link> <span class=md-ellipsis> UL-07 Kundensegmentierung </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3 id=__nav_2_3_label tabindex> <span class=md-ellipsis> Phase 3 - Vertiefung </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_3_label aria-expanded=false> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Phase 3 - Vertiefung </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ul-08-weinqualitaet/ class=md-nav__link> <span class=md-ellipsis> UL-08 Weinqualität </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4 id=__nav_2_4_label tabindex> <span class=md-ellipsis> Phase 4 - Projekt </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_4_label aria-expanded=false> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Phase 4 - Projekt </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ul-09-musik-clustering/ class=md-nav__link> <span class=md-ellipsis> UL-09 Musik-Clustering </span> </a> </li> <li class=md-nav__item> <a href=../ul-10-abschlussprojekt/ class=md-nav__link> <span class=md-ellipsis> UL-10 Abschlussprojekt </span> </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--section md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5 id=__nav_2_5_label tabindex> <span class=md-ellipsis> Optional </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=2 aria-labelledby=__nav_2_5_label aria-expanded=false> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Optional </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ul-opt-01-kreditkarten/ class=md-nav__link> <span class=md-ellipsis> UL-OPT-01 Kreditkarten </span> </a> </li> <li class=md-nav__item> <a href=../ul-opt-02-big-data/ class=md-nav__link> <span class=md-ellipsis> UL-OPT-02 Big Data </span> </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle " type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3 id=__nav_3_label tabindex=0> <span class=md-ellipsis> Infoblätter </span> <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav data-md-level=1 aria-labelledby=__nav_3_label aria-expanded=false> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Infoblätter </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../infoblaetter/einfuehrung-unsupervised/ class=md-nav__link> <span class=md-ellipsis> I-01 Einführung UL </span> </a> </li> <li class=md-nav__item> <a href=../../infoblaetter/datenvorverarbeitung/ class=md-nav__link> <span class=md-ellipsis> I-02 Vorverarbeitung </span> </a> </li> <li class=md-nav__item> <a href=../../infoblaetter/kmeans-clustering/ class=md-nav__link> <span class=md-ellipsis> I-03 K-Means </span> </a> </li> <li class=md-nav__item> <a href=../../infoblaetter/hierarchisches-clustering/ class=md-nav__link> <span class=md-ellipsis> I-04 Hierarchisch </span> </a> </li> <li class=md-nav__item> <a href=../../infoblaetter/pca-dimensionsreduktion/ class=md-nav__link> <span class=md-ellipsis> I-05 PCA </span> </a> </li> <li class=md-nav__item> <a href=../../infoblaetter/weitere-algorithmen/ class=md-nav__link> <span class=md-ellipsis> I-06 Weitere Algorithmen </span> </a> </li> <li class=md-nav__item> <a href=../../infoblaetter/cluster-evaluation/ class=md-nav__link> <span class=md-ellipsis> I-07 Evaluation </span> </a> </li> <li class=md-nav__item> <a href=../../infoblaetter/grosse-datenmengen/ class=md-nav__link> <span class=md-ellipsis> I-08 Große Datenmengen </span> </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=Inhaltsverzeichnis> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Inhaltsverzeichnis </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#lernziele class=md-nav__link> <span class=md-ellipsis> Lernziele </span> </a> </li> <li class=md-nav__item> <a href=#aufgabe-1-daten-vorbereiten class=md-nav__link> <span class=md-ellipsis> Aufgabe 1: Daten vorbereiten </span> </a> </li> <li class=md-nav__item> <a href=#aufgabe-2-linkage-matrix-berechnen class=md-nav__link> <span class=md-ellipsis> Aufgabe 2: Linkage-Matrix berechnen </span> </a> </li> <li class=md-nav__item> <a href=#aufgabe-3-dendrogramm-erstellen class=md-nav__link> <span class=md-ellipsis> Aufgabe 3: Dendrogramm erstellen </span> </a> </li> <li class=md-nav__item> <a href=#aufgabe-4-schnitt-auf-gewunschter-hohe class=md-nav__link> <span class=md-ellipsis> Aufgabe 4: Schnitt auf gewünschter Höhe </span> </a> </li> <li class=md-nav__item> <a href=#aufgabe-6-vergleich-k-means-vs-hierarchisches-clustering class=md-nav__link> <span class=md-ellipsis> Aufgabe 6: Vergleich K-Means vs. Hierarchisches Clustering </span> </a> </li> <li class=md-nav__item> <a href=#aufgabe-7-verschiedene-linkage-methoden-vergleichen class=md-nav__link> <span class=md-ellipsis> Aufgabe 7: Verschiedene Linkage-Methoden vergleichen </span> </a> </li> <li class=md-nav__item> <a href=#aufgabe-8-vor-und-nachteile-diskutieren class=md-nav__link> <span class=md-ellipsis> Aufgabe 8: Vor- und Nachteile diskutieren </span> </a> </li> <li class=md-nav__item> <a href=#haufige-fehler class=md-nav__link> <span class=md-ellipsis> Häufige Fehler </span> </a> </li> <li class=md-nav__item> <a href=#zusammenfassung class=md-nav__link> <span class=md-ellipsis> Zusammenfassung </span> </a> </li> <li class=md-nav__item> <a href=#nachste-schritte class=md-nav__link> <span class=md-ellipsis> Nächste Schritte </span> </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=ul-06-hierarchisches-clustering>UL-06: Hierarchisches Clustering<a class=headerlink href=#ul-06-hierarchisches-clustering title="Permanent link">&para;</a></h1> <div class="admonition abstract"> <p class=admonition-title>Advance Organizer</p> <p>K-Means zwingt dich, die Clusteranzahl vorher festzulegen. Hierarchisches Clustering zeigt dir stattdessen eine Baumstruktur (Dendrogramm), aus der du verschiedene Ebenen ablesen kannst. Das ist besonders nützlich, wenn du die "natürliche" Struktur der Daten entdecken möchtest.</p> <p><strong>Dein Ziel:</strong> Du verstehst den Unterschied zwischen K-Means und hierarchischem Clustering und kannst für einen Use Case entscheiden, welcher Algorithmus besser passt.</p> </div> <hr> <h2 id=lernziele>Lernziele<a class=headerlink href=#lernziele title="Permanent link">&para;</a></h2> <p>Nach Bearbeitung dieses Arbeitsblatts kannst du:</p> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Hierarchisches Clustering verstehen und erklären</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Dendrogramme erstellen und interpretieren</li> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled checked><span class=task-list-indicator></span></label> Verschiedene Linkage-Methoden vergleichen</li> </ul> <hr> <h2 id=aufgabe-1-daten-vorbereiten>Aufgabe 1: Daten vorbereiten<a class=headerlink href=#aufgabe-1-daten-vorbereiten title="Permanent link">&para;</a></h2> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Erledigt</li> </ul> <div class=highlight><pre><span></span><code><a id=__codelineno-0-1 name=__codelineno-0-1 href=#__codelineno-0-1></a><span class=kn>import</span><span class=w> </span><span class=nn>pandas</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>pd</span>
<a id=__codelineno-0-2 name=__codelineno-0-2 href=#__codelineno-0-2></a><span class=kn>import</span><span class=w> </span><span class=nn>numpy</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>np</span>
<a id=__codelineno-0-3 name=__codelineno-0-3 href=#__codelineno-0-3></a><span class=kn>import</span><span class=w> </span><span class=nn>matplotlib.pyplot</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>plt</span>
<a id=__codelineno-0-4 name=__codelineno-0-4 href=#__codelineno-0-4></a><span class=kn>import</span><span class=w> </span><span class=nn>seaborn</span><span class=w> </span><span class=k>as</span><span class=w> </span><span class=nn>sns</span>
<a id=__codelineno-0-5 name=__codelineno-0-5 href=#__codelineno-0-5></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.preprocessing</span><span class=w> </span><span class=kn>import</span> <span class=n>StandardScaler</span>
<a id=__codelineno-0-6 name=__codelineno-0-6 href=#__codelineno-0-6></a><span class=kn>from</span><span class=w> </span><span class=nn>scipy.cluster.hierarchy</span><span class=w> </span><span class=kn>import</span> <span class=n>dendrogram</span><span class=p>,</span> <span class=n>linkage</span><span class=p>,</span> <span class=n>fcluster</span>
<a id=__codelineno-0-7 name=__codelineno-0-7 href=#__codelineno-0-7></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.cluster</span><span class=w> </span><span class=kn>import</span> <span class=n>AgglomerativeClustering</span>
<a id=__codelineno-0-8 name=__codelineno-0-8 href=#__codelineno-0-8></a>
<a id=__codelineno-0-9 name=__codelineno-0-9 href=#__codelineno-0-9></a><span class=c1># Daten laden und skalieren</span>
<a id=__codelineno-0-10 name=__codelineno-0-10 href=#__codelineno-0-10></a><span class=n>df</span> <span class=o>=</span> <span class=n>pd</span><span class=o>.</span><span class=n>read_csv</span><span class=p>(</span><span class=s1>&#39;Country-data.csv&#39;</span><span class=p>)</span>
<a id=__codelineno-0-11 name=__codelineno-0-11 href=#__codelineno-0-11></a><span class=n>numeric_cols</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>select_dtypes</span><span class=p>(</span><span class=n>include</span><span class=o>=</span><span class=p>[</span><span class=n>np</span><span class=o>.</span><span class=n>number</span><span class=p>])</span><span class=o>.</span><span class=n>columns</span><span class=o>.</span><span class=n>tolist</span><span class=p>()</span>
<a id=__codelineno-0-12 name=__codelineno-0-12 href=#__codelineno-0-12></a>
<a id=__codelineno-0-13 name=__codelineno-0-13 href=#__codelineno-0-13></a><span class=n>X</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=n>numeric_cols</span><span class=p>]</span>
<a id=__codelineno-0-14 name=__codelineno-0-14 href=#__codelineno-0-14></a><span class=n>scaler</span> <span class=o>=</span> <span class=n>StandardScaler</span><span class=p>()</span>
<a id=__codelineno-0-15 name=__codelineno-0-15 href=#__codelineno-0-15></a><span class=n>X_scaled</span> <span class=o>=</span> <span class=n>scaler</span><span class=o>.</span><span class=n>fit_transform</span><span class=p>(</span><span class=n>X</span><span class=p>)</span>
<a id=__codelineno-0-16 name=__codelineno-0-16 href=#__codelineno-0-16></a>
<a id=__codelineno-0-17 name=__codelineno-0-17 href=#__codelineno-0-17></a><span class=n>countries</span> <span class=o>=</span> <span class=n>df</span><span class=p>[</span><span class=s1>&#39;country&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>values</span>
</code></pre></div> <p><strong>Prüfe dein Setup:</strong></p> <p>a) Wie viele Länder und wie viele Features hat der Datensatz?</p> <p>b) Warum ist Skalierung auch für hierarchisches Clustering wichtig?</p> <hr> <h2 id=aufgabe-2-linkage-matrix-berechnen>Aufgabe 2: Linkage-Matrix berechnen<a class=headerlink href=#aufgabe-2-linkage-matrix-berechnen title="Permanent link">&para;</a></h2> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Erledigt</li> </ul> <p>Hierarchisches Clustering baut einen Baum auf, in dem ähnliche Punkte schrittweise zusammengefügt werden:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-1-1 name=__codelineno-1-1 href=#__codelineno-1-1></a><span class=c1># Linkage-Matrix berechnen (Ward-Methode)</span>
<a id=__codelineno-1-2 name=__codelineno-1-2 href=#__codelineno-1-2></a><span class=n>Z</span> <span class=o>=</span> <span class=n>linkage</span><span class=p>(</span><span class=n>X_scaled</span><span class=p>,</span> <span class=n>method</span><span class=o>=</span><span class=s1>&#39;ward&#39;</span><span class=p>)</span>
<a id=__codelineno-1-3 name=__codelineno-1-3 href=#__codelineno-1-3></a>
<a id=__codelineno-1-4 name=__codelineno-1-4 href=#__codelineno-1-4></a><span class=c1># Struktur der Linkage-Matrix</span>
<a id=__codelineno-1-5 name=__codelineno-1-5 href=#__codelineno-1-5></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Linkage-Matrix Shape:&quot;</span><span class=p>,</span> <span class=n>Z</span><span class=o>.</span><span class=n>shape</span><span class=p>)</span>
<a id=__codelineno-1-6 name=__codelineno-1-6 href=#__codelineno-1-6></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Beispiel der ersten Merge-Schritte:&quot;</span><span class=p>)</span>
<a id=__codelineno-1-7 name=__codelineno-1-7 href=#__codelineno-1-7></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;Cluster 1 | Cluster 2 | Distanz | Anzahl Punkte&quot;</span><span class=p>)</span>
<a id=__codelineno-1-8 name=__codelineno-1-8 href=#__codelineno-1-8></a><span class=nb>print</span><span class=p>(</span><span class=n>Z</span><span class=p>[:</span><span class=mi>5</span><span class=p>]</span><span class=o>.</span><span class=n>round</span><span class=p>(</span><span class=mi>2</span><span class=p>))</span>
</code></pre></div> <p><strong>Analysiere die Linkage-Matrix:</strong></p> <p>a) Wie viele Zeilen hat die Matrix? (Tipp: Bei n Datenpunkten gibt es n-1 Merge-Schritte)</p> <p>b) Schau dir die ersten Merge-Schritte an: Welche Distanzen haben die ersten Zusammenführungen? Sind das ähnliche oder unähnliche Punkte?</p> <p>c) Wie verändert sich die Distanz in Spalte 2 über die Zeilen hinweg?</p> <p><strong>Die Linkage-Matrix erklärt:</strong></p> <table> <thead> <tr> <th>Spalte</th> <th>Bedeutung</th> </tr> </thead> <tbody> <tr> <td>0</td> <td>Index des ersten zusammengeführten Clusters</td> </tr> <tr> <td>1</td> <td>Index des zweiten zusammengeführten Clusters</td> </tr> <tr> <td>2</td> <td>Distanz zwischen den Clustern</td> </tr> <tr> <td>3</td> <td>Anzahl Punkte im neuen Cluster</td> </tr> </tbody> </table> <hr> <h2 id=aufgabe-3-dendrogramm-erstellen>Aufgabe 3: Dendrogramm erstellen<a class=headerlink href=#aufgabe-3-dendrogramm-erstellen title="Permanent link">&para;</a></h2> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Erledigt</li> </ul> <p>Das Dendrogramm visualisiert die hierarchische Struktur:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-2-1 name=__codelineno-2-1 href=#__codelineno-2-1></a><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>8</span><span class=p>))</span>
<a id=__codelineno-2-2 name=__codelineno-2-2 href=#__codelineno-2-2></a>
<a id=__codelineno-2-3 name=__codelineno-2-3 href=#__codelineno-2-3></a><span class=c1># Dendrogramm mit Ländernamen</span>
<a id=__codelineno-2-4 name=__codelineno-2-4 href=#__codelineno-2-4></a><span class=n>dendrogram</span><span class=p>(</span><span class=n>Z</span><span class=p>,</span> 
<a id=__codelineno-2-5 name=__codelineno-2-5 href=#__codelineno-2-5></a>           <span class=n>labels</span><span class=o>=</span><span class=n>countries</span><span class=p>,</span>
<a id=__codelineno-2-6 name=__codelineno-2-6 href=#__codelineno-2-6></a>           <span class=n>leaf_rotation</span><span class=o>=</span><span class=mi>90</span><span class=p>,</span>
<a id=__codelineno-2-7 name=__codelineno-2-7 href=#__codelineno-2-7></a>           <span class=n>leaf_font_size</span><span class=o>=</span><span class=mi>8</span><span class=p>)</span>
<a id=__codelineno-2-8 name=__codelineno-2-8 href=#__codelineno-2-8></a>
<a id=__codelineno-2-9 name=__codelineno-2-9 href=#__codelineno-2-9></a><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=s1>&#39;Dendrogramm der Länder (Ward-Methode)&#39;</span><span class=p>)</span>
<a id=__codelineno-2-10 name=__codelineno-2-10 href=#__codelineno-2-10></a><span class=n>plt</span><span class=o>.</span><span class=n>xlabel</span><span class=p>(</span><span class=s1>&#39;Länder&#39;</span><span class=p>)</span>
<a id=__codelineno-2-11 name=__codelineno-2-11 href=#__codelineno-2-11></a><span class=n>plt</span><span class=o>.</span><span class=n>ylabel</span><span class=p>(</span><span class=s1>&#39;Distanz&#39;</span><span class=p>)</span>
<a id=__codelineno-2-12 name=__codelineno-2-12 href=#__codelineno-2-12></a><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
<a id=__codelineno-2-13 name=__codelineno-2-13 href=#__codelineno-2-13></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><strong>Analysiere das Dendrogramm:</strong></p> <p>a) Bei welcher Distanz (y-Achse) würde das Dendrogramm in 2 Cluster zerfallen? Bei welcher in 3?</p> <p>b) Gibt es Länder, die besonders früh (unten) zusammengeführt werden? Welche sind das?</p> <p>c) Gibt es Länder, die erst sehr spät (oben) zusammengeführt werden? Was bedeutet das?</p> <p><strong>Wie liest man ein Dendrogramm?</strong></p> <ul> <li><strong>Horizontale Linien:</strong> Zusammenführung zweier Cluster</li> <li><strong>Höhe der Linien:</strong> Distanz (je höher, desto unähnlicher)</li> <li><strong>Vertikale Äste:</strong> Einzelne Datenpunkte oder Cluster</li> </ul> <hr> <h2 id=aufgabe-4-schnitt-auf-gewunschter-hohe>Aufgabe 4: Schnitt auf gewünschter Höhe<a class=headerlink href=#aufgabe-4-schnitt-auf-gewunschter-hohe title="Permanent link">&para;</a></h2> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Erledigt</li> </ul> <p>Du kannst das Dendrogramm auf verschiedenen Höhen "schneiden":</p> <div class=highlight><pre><span></span><code><a id=__codelineno-3-1 name=__codelineno-3-1 href=#__codelineno-3-1></a><span class=n>fig</span><span class=p>,</span> <span class=n>axes</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>1</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
<a id=__codelineno-3-2 name=__codelineno-3-2 href=#__codelineno-3-2></a>
<a id=__codelineno-3-3 name=__codelineno-3-3 href=#__codelineno-3-3></a><span class=c1># Dendrogramm mit Schnittlinien</span>
<a id=__codelineno-3-4 name=__codelineno-3-4 href=#__codelineno-3-4></a><span class=k>for</span> <span class=n>ax</span><span class=p>,</span> <span class=n>n_clusters</span><span class=p>,</span> <span class=n>color</span> <span class=ow>in</span> <span class=p>[(</span><span class=n>axes</span><span class=p>[</span><span class=mi>0</span><span class=p>],</span> <span class=mi>3</span><span class=p>,</span> <span class=s1>&#39;red&#39;</span><span class=p>),</span> <span class=p>(</span><span class=n>axes</span><span class=p>[</span><span class=mi>1</span><span class=p>],</span> <span class=mi>5</span><span class=p>,</span> <span class=s1>&#39;green&#39;</span><span class=p>)]:</span>
<a id=__codelineno-3-5 name=__codelineno-3-5 href=#__codelineno-3-5></a>    <span class=n>dendrogram</span><span class=p>(</span><span class=n>Z</span><span class=p>,</span> <span class=n>labels</span><span class=o>=</span><span class=n>countries</span><span class=p>,</span> <span class=n>leaf_rotation</span><span class=o>=</span><span class=mi>90</span><span class=p>,</span> <span class=n>leaf_font_size</span><span class=o>=</span><span class=mi>8</span><span class=p>,</span> <span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>)</span>
<a id=__codelineno-3-6 name=__codelineno-3-6 href=#__codelineno-3-6></a>
<a id=__codelineno-3-7 name=__codelineno-3-7 href=#__codelineno-3-7></a>    <span class=c1># Schwellenwert für n Cluster finden</span>
<a id=__codelineno-3-8 name=__codelineno-3-8 href=#__codelineno-3-8></a>    <span class=n>labels_temp</span> <span class=o>=</span> <span class=n>fcluster</span><span class=p>(</span><span class=n>Z</span><span class=p>,</span> <span class=n>n_clusters</span><span class=p>,</span> <span class=n>criterion</span><span class=o>=</span><span class=s1>&#39;maxclust&#39;</span><span class=p>)</span>
<a id=__codelineno-3-9 name=__codelineno-3-9 href=#__codelineno-3-9></a>    <span class=n>threshold</span> <span class=o>=</span> <span class=n>Z</span><span class=p>[</span><span class=o>-</span><span class=p>(</span><span class=n>n_clusters</span><span class=o>-</span><span class=mi>1</span><span class=p>),</span> <span class=mi>2</span><span class=p>]</span>
<a id=__codelineno-3-10 name=__codelineno-3-10 href=#__codelineno-3-10></a>
<a id=__codelineno-3-11 name=__codelineno-3-11 href=#__codelineno-3-11></a>    <span class=n>ax</span><span class=o>.</span><span class=n>axhline</span><span class=p>(</span><span class=n>y</span><span class=o>=</span><span class=n>threshold</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=n>color</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s1>&#39;--&#39;</span><span class=p>,</span> <span class=n>linewidth</span><span class=o>=</span><span class=mi>2</span><span class=p>,</span> 
<a id=__codelineno-3-12 name=__codelineno-3-12 href=#__codelineno-3-12></a>               <span class=n>label</span><span class=o>=</span><span class=sa>f</span><span class=s1>&#39;Schnitt für </span><span class=si>{</span><span class=n>n_clusters</span><span class=si>}</span><span class=s1> Cluster&#39;</span><span class=p>)</span>
<a id=__codelineno-3-13 name=__codelineno-3-13 href=#__codelineno-3-13></a>    <span class=n>ax</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
<a id=__codelineno-3-14 name=__codelineno-3-14 href=#__codelineno-3-14></a>    <span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;</span><span class=si>{</span><span class=n>n_clusters</span><span class=si>}</span><span class=s1> Cluster&#39;</span><span class=p>)</span>
<a id=__codelineno-3-15 name=__codelineno-3-15 href=#__codelineno-3-15></a>
<a id=__codelineno-3-16 name=__codelineno-3-16 href=#__codelineno-3-16></a><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
<a id=__codelineno-3-17 name=__codelineno-3-17 href=#__codelineno-3-17></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><strong>Vergleiche die beiden Schnitte:</strong></p> <p>a) Bei welcher Höhe liegt die rote Linie (3 Cluster)? Bei welcher die grüne (5 Cluster)?</p> <p>b) Welcher Schnitt erscheint dir "natürlicher" – wo gibt es größere Lücken zwischen den Clustern?</p> <p>c) Was ist der Vorteil davon, dass du die Clusteranzahl <em>nachträglich</em> festlegen kannst?</p> <p>Extrahiere die Cluster-Labels für eine bestimmte Anzahl:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-4-1 name=__codelineno-4-1 href=#__codelineno-4-1></a><span class=c1># 3 Cluster extrahieren</span>
<a id=__codelineno-4-2 name=__codelineno-4-2 href=#__codelineno-4-2></a><span class=n>n_clusters</span> <span class=o>=</span> <span class=mi>3</span>
<a id=__codelineno-4-3 name=__codelineno-4-3 href=#__codelineno-4-3></a><span class=n>labels_hc</span> <span class=o>=</span> <span class=n>fcluster</span><span class=p>(</span><span class=n>Z</span><span class=p>,</span> <span class=n>n_clusters</span><span class=p>,</span> <span class=n>criterion</span><span class=o>=</span><span class=s1>&#39;maxclust&#39;</span><span class=p>)</span>
<a id=__codelineno-4-4 name=__codelineno-4-4 href=#__codelineno-4-4></a>
<a id=__codelineno-4-5 name=__codelineno-4-5 href=#__codelineno-4-5></a><span class=c1># Achtung: fcluster gibt Labels ab 1 (nicht 0!)</span>
<a id=__codelineno-4-6 name=__codelineno-4-6 href=#__codelineno-4-6></a><span class=n>labels_hc</span> <span class=o>=</span> <span class=n>labels_hc</span> <span class=o>-</span> <span class=mi>1</span>  <span class=c1># Anpassen auf 0-indexiert</span>
<a id=__codelineno-4-7 name=__codelineno-4-7 href=#__codelineno-4-7></a>
<a id=__codelineno-4-8 name=__codelineno-4-8 href=#__codelineno-4-8></a><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Cluster_HC&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>labels_hc</span>
<a id=__codelineno-4-9 name=__codelineno-4-9 href=#__codelineno-4-9></a><span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Cluster_HC&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>value_counts</span><span class=p>()</span><span class=o>.</span><span class=n>sort_index</span><span class=p>())</span>
</code></pre></div> <p><strong>Alternative mit AgglomerativeClustering:</strong></p> <div class=highlight><pre><span></span><code><a id=__codelineno-5-1 name=__codelineno-5-1 href=#__codelineno-5-1></a><span class=n>agg</span> <span class=o>=</span> <span class=n>AgglomerativeClustering</span><span class=p>(</span><span class=n>n_clusters</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>linkage</span><span class=o>=</span><span class=s1>&#39;ward&#39;</span><span class=p>)</span>
<a id=__codelineno-5-2 name=__codelineno-5-2 href=#__codelineno-5-2></a><span class=n>labels_agg</span> <span class=o>=</span> <span class=n>agg</span><span class=o>.</span><span class=n>fit_predict</span><span class=p>(</span><span class=n>X_scaled</span><span class=p>)</span>
<a id=__codelineno-5-3 name=__codelineno-5-3 href=#__codelineno-5-3></a>
<a id=__codelineno-5-4 name=__codelineno-5-4 href=#__codelineno-5-4></a><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Cluster_Agg&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>labels_agg</span>
<a id=__codelineno-5-5 name=__codelineno-5-5 href=#__codelineno-5-5></a><span class=nb>print</span><span class=p>(</span><span class=n>df</span><span class=p>[</span><span class=s1>&#39;Cluster_Agg&#39;</span><span class=p>]</span><span class=o>.</span><span class=n>value_counts</span><span class=p>()</span><span class=o>.</span><span class=n>sort_index</span><span class=p>())</span>
</code></pre></div> <p><strong>Vergleiche die beiden Methoden:</strong></p> <p>a) Liefern <code>fcluster()</code> und <code>AgglomerativeClustering</code> die gleichen Ergebnisse bei gleicher Clusteranzahl?</p> <p>b) Wann würdest du welche Methode verwenden? (Tipp: <code>fcluster</code> braucht die Linkage-Matrix, <code>AgglomerativeClustering</code> nicht)</p> <hr> <h2 id=aufgabe-6-vergleich-k-means-vs-hierarchisches-clustering>Aufgabe 6: Vergleich K-Means vs. Hierarchisches Clustering<a class=headerlink href=#aufgabe-6-vergleich-k-means-vs-hierarchisches-clustering title="Permanent link">&para;</a></h2> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Erledigt</li> </ul> <p>Vergleiche die Ergebnisse beider Methoden:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-6-1 name=__codelineno-6-1 href=#__codelineno-6-1></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.cluster</span><span class=w> </span><span class=kn>import</span> <span class=n>KMeans</span>
<a id=__codelineno-6-2 name=__codelineno-6-2 href=#__codelineno-6-2></a><span class=kn>from</span><span class=w> </span><span class=nn>sklearn.metrics</span><span class=w> </span><span class=kn>import</span> <span class=n>adjusted_rand_score</span>
<a id=__codelineno-6-3 name=__codelineno-6-3 href=#__codelineno-6-3></a>
<a id=__codelineno-6-4 name=__codelineno-6-4 href=#__codelineno-6-4></a><span class=c1># K-Means</span>
<a id=__codelineno-6-5 name=__codelineno-6-5 href=#__codelineno-6-5></a><span class=n>kmeans</span> <span class=o>=</span> <span class=n>KMeans</span><span class=p>(</span><span class=n>n_clusters</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>random_state</span><span class=o>=</span><span class=mi>42</span><span class=p>,</span> <span class=n>n_init</span><span class=o>=</span><span class=mi>10</span><span class=p>)</span>
<a id=__codelineno-6-6 name=__codelineno-6-6 href=#__codelineno-6-6></a><span class=n>labels_km</span> <span class=o>=</span> <span class=n>kmeans</span><span class=o>.</span><span class=n>fit_predict</span><span class=p>(</span><span class=n>X_scaled</span><span class=p>)</span>
<a id=__codelineno-6-7 name=__codelineno-6-7 href=#__codelineno-6-7></a>
<a id=__codelineno-6-8 name=__codelineno-6-8 href=#__codelineno-6-8></a><span class=c1># Hierarchisch (Ward)</span>
<a id=__codelineno-6-9 name=__codelineno-6-9 href=#__codelineno-6-9></a><span class=n>agg</span> <span class=o>=</span> <span class=n>AgglomerativeClustering</span><span class=p>(</span><span class=n>n_clusters</span><span class=o>=</span><span class=mi>3</span><span class=p>,</span> <span class=n>linkage</span><span class=o>=</span><span class=s1>&#39;ward&#39;</span><span class=p>)</span>
<a id=__codelineno-6-10 name=__codelineno-6-10 href=#__codelineno-6-10></a><span class=n>labels_hc</span> <span class=o>=</span> <span class=n>agg</span><span class=o>.</span><span class=n>fit_predict</span><span class=p>(</span><span class=n>X_scaled</span><span class=p>)</span>
<a id=__codelineno-6-11 name=__codelineno-6-11 href=#__codelineno-6-11></a>
<a id=__codelineno-6-12 name=__codelineno-6-12 href=#__codelineno-6-12></a><span class=c1># Übereinstimmung</span>
<a id=__codelineno-6-13 name=__codelineno-6-13 href=#__codelineno-6-13></a><span class=n>ari</span> <span class=o>=</span> <span class=n>adjusted_rand_score</span><span class=p>(</span><span class=n>labels_km</span><span class=p>,</span> <span class=n>labels_hc</span><span class=p>)</span>
<a id=__codelineno-6-14 name=__codelineno-6-14 href=#__codelineno-6-14></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;Adjusted Rand Index: </span><span class=si>{</span><span class=n>ari</span><span class=si>:</span><span class=s2>.3f</span><span class=si>}</span><span class=s2>&quot;</span><span class=p>)</span>
<a id=__codelineno-6-15 name=__codelineno-6-15 href=#__codelineno-6-15></a>
<a id=__codelineno-6-16 name=__codelineno-6-16 href=#__codelineno-6-16></a><span class=c1># Crosstab für detaillierten Vergleich</span>
<a id=__codelineno-6-17 name=__codelineno-6-17 href=#__codelineno-6-17></a><span class=nb>print</span><span class=p>(</span><span class=s2>&quot;</span><span class=se>\n</span><span class=s2>Vergleich der Zuordnungen:&quot;</span><span class=p>)</span>
<a id=__codelineno-6-18 name=__codelineno-6-18 href=#__codelineno-6-18></a><span class=nb>print</span><span class=p>(</span><span class=n>pd</span><span class=o>.</span><span class=n>crosstab</span><span class=p>(</span><span class=n>labels_km</span><span class=p>,</span> <span class=n>labels_hc</span><span class=p>,</span> 
<a id=__codelineno-6-19 name=__codelineno-6-19 href=#__codelineno-6-19></a>                  <span class=n>rownames</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;K-Means&#39;</span><span class=p>],</span> 
<a id=__codelineno-6-20 name=__codelineno-6-20 href=#__codelineno-6-20></a>                  <span class=n>colnames</span><span class=o>=</span><span class=p>[</span><span class=s1>&#39;Hierarchisch&#39;</span><span class=p>]))</span>
</code></pre></div> <p><strong>Fragen:</strong></p> <p>a) Wie stark stimmen die beiden Methoden überein?</p> <p>b) Welche Länder werden unterschiedlich zugeordnet?</p> <div class=highlight><pre><span></span><code><a id=__codelineno-7-1 name=__codelineno-7-1 href=#__codelineno-7-1></a><span class=c1># Unterschiedlich zugeordnete Länder finden</span>
<a id=__codelineno-7-2 name=__codelineno-7-2 href=#__codelineno-7-2></a><span class=n>df_temp</span> <span class=o>=</span> <span class=n>df</span><span class=o>.</span><span class=n>copy</span><span class=p>()</span>
<a id=__codelineno-7-3 name=__codelineno-7-3 href=#__codelineno-7-3></a><span class=n>df_temp</span><span class=p>[</span><span class=s1>&#39;KM&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>labels_km</span>
<a id=__codelineno-7-4 name=__codelineno-7-4 href=#__codelineno-7-4></a><span class=n>df_temp</span><span class=p>[</span><span class=s1>&#39;HC&#39;</span><span class=p>]</span> <span class=o>=</span> <span class=n>labels_hc</span>
<a id=__codelineno-7-5 name=__codelineno-7-5 href=#__codelineno-7-5></a><span class=n>disagree</span> <span class=o>=</span> <span class=n>df_temp</span><span class=p>[</span><span class=n>df_temp</span><span class=p>[</span><span class=s1>&#39;KM&#39;</span><span class=p>]</span> <span class=o>!=</span> <span class=n>df_temp</span><span class=p>[</span><span class=s1>&#39;HC&#39;</span><span class=p>]]</span>
<a id=__codelineno-7-6 name=__codelineno-7-6 href=#__codelineno-7-6></a><span class=nb>print</span><span class=p>(</span><span class=sa>f</span><span class=s2>&quot;</span><span class=se>\n</span><span class=si>{</span><span class=nb>len</span><span class=p>(</span><span class=n>disagree</span><span class=p>)</span><span class=si>}</span><span class=s2> Länder mit unterschiedlicher Zuordnung:&quot;</span><span class=p>)</span>
<a id=__codelineno-7-7 name=__codelineno-7-7 href=#__codelineno-7-7></a><span class=nb>print</span><span class=p>(</span><span class=n>disagree</span><span class=p>[[</span><span class=s1>&#39;country&#39;</span><span class=p>,</span> <span class=s1>&#39;KM&#39;</span><span class=p>,</span> <span class=s1>&#39;HC&#39;</span><span class=p>]])</span>
</code></pre></div> <hr> <h2 id=aufgabe-7-verschiedene-linkage-methoden-vergleichen>Aufgabe 7: Verschiedene Linkage-Methoden vergleichen<a class=headerlink href=#aufgabe-7-verschiedene-linkage-methoden-vergleichen title="Permanent link">&para;</a></h2> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Erledigt</li> </ul> <p>Es gibt mehrere Methoden, die Distanz zwischen Clustern zu berechnen:</p> <div class=highlight><pre><span></span><code><a id=__codelineno-8-1 name=__codelineno-8-1 href=#__codelineno-8-1></a><span class=n>methods</span> <span class=o>=</span> <span class=p>[</span><span class=s1>&#39;single&#39;</span><span class=p>,</span> <span class=s1>&#39;complete&#39;</span><span class=p>,</span> <span class=s1>&#39;average&#39;</span><span class=p>,</span> <span class=s1>&#39;ward&#39;</span><span class=p>]</span>
<a id=__codelineno-8-2 name=__codelineno-8-2 href=#__codelineno-8-2></a>
<a id=__codelineno-8-3 name=__codelineno-8-3 href=#__codelineno-8-3></a><span class=n>fig</span><span class=p>,</span> <span class=n>axes</span> <span class=o>=</span> <span class=n>plt</span><span class=o>.</span><span class=n>subplots</span><span class=p>(</span><span class=mi>2</span><span class=p>,</span> <span class=mi>2</span><span class=p>,</span> <span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>16</span><span class=p>,</span> <span class=mi>12</span><span class=p>))</span>
<a id=__codelineno-8-4 name=__codelineno-8-4 href=#__codelineno-8-4></a>
<a id=__codelineno-8-5 name=__codelineno-8-5 href=#__codelineno-8-5></a><span class=k>for</span> <span class=n>ax</span><span class=p>,</span> <span class=n>method</span> <span class=ow>in</span> <span class=nb>zip</span><span class=p>(</span><span class=n>axes</span><span class=o>.</span><span class=n>flatten</span><span class=p>(),</span> <span class=n>methods</span><span class=p>):</span>
<a id=__codelineno-8-6 name=__codelineno-8-6 href=#__codelineno-8-6></a>    <span class=n>Z_method</span> <span class=o>=</span> <span class=n>linkage</span><span class=p>(</span><span class=n>X_scaled</span><span class=p>,</span> <span class=n>method</span><span class=o>=</span><span class=n>method</span><span class=p>)</span>
<a id=__codelineno-8-7 name=__codelineno-8-7 href=#__codelineno-8-7></a>    <span class=n>dendrogram</span><span class=p>(</span><span class=n>Z_method</span><span class=p>,</span> 
<a id=__codelineno-8-8 name=__codelineno-8-8 href=#__codelineno-8-8></a>               <span class=n>labels</span><span class=o>=</span><span class=n>countries</span><span class=p>,</span>
<a id=__codelineno-8-9 name=__codelineno-8-9 href=#__codelineno-8-9></a>               <span class=n>leaf_rotation</span><span class=o>=</span><span class=mi>90</span><span class=p>,</span>
<a id=__codelineno-8-10 name=__codelineno-8-10 href=#__codelineno-8-10></a>               <span class=n>leaf_font_size</span><span class=o>=</span><span class=mi>6</span><span class=p>,</span>
<a id=__codelineno-8-11 name=__codelineno-8-11 href=#__codelineno-8-11></a>               <span class=n>ax</span><span class=o>=</span><span class=n>ax</span><span class=p>,</span>
<a id=__codelineno-8-12 name=__codelineno-8-12 href=#__codelineno-8-12></a>               <span class=n>truncate_mode</span><span class=o>=</span><span class=s1>&#39;lastp&#39;</span><span class=p>,</span>
<a id=__codelineno-8-13 name=__codelineno-8-13 href=#__codelineno-8-13></a>               <span class=n>p</span><span class=o>=</span><span class=mi>30</span><span class=p>)</span>  <span class=c1># Nur letzte 30 Merges zeigen</span>
<a id=__codelineno-8-14 name=__codelineno-8-14 href=#__codelineno-8-14></a>    <span class=n>ax</span><span class=o>.</span><span class=n>set_title</span><span class=p>(</span><span class=sa>f</span><span class=s1>&#39;Linkage-Methode: </span><span class=si>{</span><span class=n>method</span><span class=si>}</span><span class=s1>&#39;</span><span class=p>)</span>
<a id=__codelineno-8-15 name=__codelineno-8-15 href=#__codelineno-8-15></a>
<a id=__codelineno-8-16 name=__codelineno-8-16 href=#__codelineno-8-16></a><span class=n>plt</span><span class=o>.</span><span class=n>tight_layout</span><span class=p>()</span>
<a id=__codelineno-8-17 name=__codelineno-8-17 href=#__codelineno-8-17></a><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</code></pre></div> <p><strong>Vergleiche die Linkage-Methoden:</strong></p> <p>a) Welche Methode erzeugt die "kettenförmigsten" Cluster (ein langes, dünnes Cluster)? Warum?</p> <p>b) Welche Methode erzeugt die "ausgewogensten" Cluster (ähnliche Größe)?</p> <p>c) Für welche Anwendungsfälle könnte <code>single</code> trotzdem sinnvoll sein?</p> <p><strong>Linkage-Methoden erklärt:</strong></p> <table> <thead> <tr> <th>Methode</th> <th>Distanz zwischen Clustern</th> </tr> </thead> <tbody> <tr> <td><strong>single</strong></td> <td>Kürzeste Distanz zwischen Punkten</td> </tr> <tr> <td><strong>complete</strong></td> <td>Längste Distanz zwischen Punkten</td> </tr> <tr> <td><strong>average</strong></td> <td>Durchschnittliche Distanz</td> </tr> <tr> <td><strong>ward</strong></td> <td>Minimiert Varianz im Cluster</td> </tr> </tbody> </table> <p><strong>Frage:</strong> Welche Methode liefert die "ausgewogensten" Cluster?</p> <hr> <h2 id=aufgabe-8-vor-und-nachteile-diskutieren>Aufgabe 8: Vor- und Nachteile diskutieren<a class=headerlink href=#aufgabe-8-vor-und-nachteile-diskutieren title="Permanent link">&para;</a></h2> <ul class=task-list> <li class=task-list-item><label class=task-list-control><input type=checkbox disabled><span class=task-list-indicator></span></label> Erledigt</li> </ul> <p>Fülle die Tabelle basierend auf deinen Erfahrungen:</p> <table> <thead> <tr> <th>Aspekt</th> <th>K-Means</th> <th>Hierarchisches Clustering</th> </tr> </thead> <tbody> <tr> <td>Muss k vorher festgelegt werden?</td> <td><strong><em>_</em></strong>__</td> <td><strong><em>_</em></strong>__</td> </tr> <tr> <td>Laufzeit bei großen Daten</td> <td><strong><em>_</em></strong>__</td> <td><strong><em>_</em></strong>__</td> </tr> <tr> <td>Cluster-Form</td> <td><strong><em>_</em></strong>__</td> <td><strong><em>_</em></strong>__</td> </tr> <tr> <td>Deterministisch?</td> <td><strong><em>_</em></strong>__</td> <td><strong><em>_</em></strong>__</td> </tr> <tr> <td>Zusätzliche Einblicke</td> <td><strong><em>_</em></strong>__</td> <td><strong><em>_</em></strong>__</td> </tr> </tbody> </table> <div class="admonition tip"> <p class=admonition-title>Wann welchen Algorithmus?</p> <ul> <li><strong>K-Means:</strong> Wenn du schnelle Ergebnisse brauchst und die ungefähre Clusteranzahl kennst</li> <li><strong>Hierarchisch:</strong> Wenn du die Struktur der Daten erkunden willst oder unsicher über k bist</li> </ul> </div> <hr> <h2 id=haufige-fehler>Häufige Fehler<a class=headerlink href=#haufige-fehler title="Permanent link">&para;</a></h2> <div class="admonition failure"> <p class=admonition-title>Typische Probleme und Lösungen</p> <p>❌ <strong>Dendrogramm zu unübersichtlich</strong><br> → Nutze <code>truncate_mode='lastp'</code>: <div class=highlight><pre><span></span><code><a id=__codelineno-9-1 name=__codelineno-9-1 href=#__codelineno-9-1></a><span class=n>dendrogram</span><span class=p>(</span><span class=n>Z</span><span class=p>,</span> <span class=n>truncate_mode</span><span class=o>=</span><span class=s1>&#39;lastp&#39;</span><span class=p>,</span> <span class=n>p</span><span class=o>=</span><span class=mi>30</span><span class=p>)</span>
</code></pre></div></p> <p>❌ <strong>Linkage-Objekt nicht verstanden</strong><br> → <code>linkage()</code> gibt eine Matrix zurück, die du an <code>dendrogram()</code> oder <code>fcluster()</code> übergibst.</p> <p>❌ <strong><code>fcluster</code> liefert falsche Anzahl</strong><br> → Prüfe den Parameter <code>t</code> (Schwellenwert) oder nutze <code>criterion='maxclust'</code>: <div class=highlight><pre><span></span><code><a id=__codelineno-10-1 name=__codelineno-10-1 href=#__codelineno-10-1></a><span class=c1># Nach Distanz-Schwelle:</span>
<a id=__codelineno-10-2 name=__codelineno-10-2 href=#__codelineno-10-2></a><span class=n>fcluster</span><span class=p>(</span><span class=n>Z</span><span class=p>,</span> <span class=n>t</span><span class=o>=</span><span class=mi>10</span><span class=p>,</span> <span class=n>criterion</span><span class=o>=</span><span class=s1>&#39;distance&#39;</span><span class=p>)</span>
<a id=__codelineno-10-3 name=__codelineno-10-3 href=#__codelineno-10-3></a>
<a id=__codelineno-10-4 name=__codelineno-10-4 href=#__codelineno-10-4></a><span class=c1># Nach Anzahl Cluster:</span>
<a id=__codelineno-10-5 name=__codelineno-10-5 href=#__codelineno-10-5></a><span class=n>fcluster</span><span class=p>(</span><span class=n>Z</span><span class=p>,</span> <span class=n>n_clusters</span><span class=p>,</span> <span class=n>criterion</span><span class=o>=</span><span class=s1>&#39;maxclust&#39;</span><span class=p>)</span>
</code></pre></div></p> <p>❌ <strong>Vergleich mit K-Means nicht sinnvoll</strong><br> → Nutze dieselbe Clusteranzahl für beide Methoden!</p> </div> <hr> <h2 id=zusammenfassung>Zusammenfassung<a class=headerlink href=#zusammenfassung title="Permanent link">&para;</a></h2> <div class="admonition success"> <p class=admonition-title>Das hast du gelernt</p> <ul> <li>Hierarchisches Clustering baut eine Baumstruktur auf</li> <li><strong>Dendrogramm:</strong> Visualisiert die hierarchische Struktur</li> <li><strong>Linkage-Methoden:</strong> single, complete, average, ward</li> <li>Du kannst nachträglich entscheiden, wie viele Cluster du haben möchtest</li> <li>Ward-Linkage liefert oft die "ausgewogensten" Cluster</li> </ul> </div> <hr> <h2 id=nachste-schritte>Nächste Schritte<a class=headerlink href=#nachste-schritte title="Permanent link">&para;</a></h2> <p>Du hast jetzt zwei wichtige Clustering-Algorithmen kennengelernt. Im nächsten Arbeitsblatt wendest du alles Gelernte eigenständig auf einen neuen Datensatz an!</p> <p>➡️ Weiter zu <a href=../ul-07-kundensegmentierung/ >UL-07: Kundensegmentierung</a></p> </article> </div> <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script> <script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script> </div> <button type=button class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg> Zurück zum Seitenanfang </button> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"annotate": null, "base": "../..", "features": ["navigation.sections", "navigation.top", "navigation.tabs", "search.suggest", "search.highlight", "content.code.copy", "content.tabs.link", "content.progress"], "search": "../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "In Zwischenablage kopiert", "clipboard.copy": "In Zwischenablage kopieren", "search.result.more.one": "1 weiteres Suchergebnis auf dieser Seite", "search.result.more.other": "# weitere Suchergebnisse auf dieser Seite", "search.result.none": "Keine Suchergebnisse", "search.result.one": "1 Suchergebnis", "search.result.other": "# Suchergebnisse", "search.result.placeholder": "Suchbegriff eingeben", "search.result.term.missing": "Es fehlt", "select.version": "Version ausw\u00e4hlen"}, "version": null}</script> <script src=../../assets/javascripts/bundle.79ae519e.min.js></script> <script src=../../assets/js/progress.js></script> </body> </html>